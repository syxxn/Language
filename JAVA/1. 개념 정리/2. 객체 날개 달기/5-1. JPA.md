## JPA(Java Persistence API)

: 자바 표준 <u>ORM</u>

> DB 테이블을 자바 객체로 매핑함으로써 객체간의 관계를 바탕으로 SQL을 자동으로 생성함
>
> -> SQL에 종속적인 개발을 하지 않아도 됨.



자바 ORM 기술에 대한 표준 명세로, JAVA에서 제공하는 API이다. ~~스프링에서 제공하는 것이 아님!~~

자바 애플리케이션에서 관계형 데이터베이스를 사용하는 방식을 정의한 인터페이스이다. 여기서 중요하게 여겨야 할 부분은, **JPA는 특정 기능을 하는 라이브러리가 아니라 말 그대로 인터페이스**라는 점이다.  스프링의 PSA에 의해서 (POJO를 사용하면서 특정 기술을 사용하기 위해서) 표준 인터페이스를 정해두었는데, 그 중 ORM을 사용하기 위해 만든 인터페이스가 바로 JPA이다.

ORM이기 때문에 자바 클래스와 DB 테이블을 매핑한다.



### JPA를 사용하는 이유

JPA를 제외하고 자바를 통해 DB에 접근할 수 있는 방법을 살펴보면 크게 `JDBC API`,`IBatis(MyBatis)`,`SQL Mapper`가 있다. 이러한 접근 방법은 CRUD의 SQL이 반복되고, SQl에 의존적인 개발을 해야 한다는 단점이 있다.

이런 문제를 해결하기 위해 객체 + 관계형 데이터베이스 모델 즉, ORM 프레임워크이다.

우선 JPA는 DAO를 생각하지 않아도 된다. Entity 클래스를 생성하는 것이 바로 DB 테이블을 만드는 것이기 때문이다. 한마디로 DB에 create 쿼리를 직접 날리지 않아도 Entity 클래스에 @Entity를 붙이는 것만으로 DB와 자동으로 매핑을 해버린다. DB가 없으면 create를 하고, 컬럼이 없으면 자동으로 alter 한다.

> JPA에서 Entity라는 것은 데이터베이스에 저장하기 위해서 유저가 정의한 클래스이다. 일반적으로 RDBMS에서 table의 정의 같은 것이다. table의 이름이나 컬럼들에 대한 정보를 가진다.



### JPA 특징

1. 데이터를 객체지향적으로 관리할 수 있기 때문에 개발자는 비즈니스 로직에 집중할 수 있고, 객체지향 개발이 가능하다
2. 자바 객체와 DB 테이블 사이의 매핑 설정을 통해 SQL을 생성한다
3. 객체를 통해 쿼리를 작성할 수 있는 JPQL(Java Persistence(영속성) Query Language)를 지원한다
4. JPA는 성능 향상을 위해 지연 로딩이나 즉시 로딩과 같은 몇가지 기법을 제공한다



### 영속성(Persistence)

영속성(Persistence)이란 데이터를 생성한 프로그램이 종료되어도 사라지지 않는 데이터의 특성을 말한다.

영속성을 갖지 않으면 데이터는 메모리에서만 존재하게 되고 프로그램이 종료되면 해당 데이터는 모두 사라지게 된다. 그래서 우리는 데이터를 파일이나 DB에 영구 저장함으로써 데이터에 영속성을 부여한다.



#### 장점

1. SQL 중심적인 개발에서 객체 중심적인 개발이 가능하다

2. 간단한 메소드로 CRUD가 가능하여 생산성이 증가한다

3. 유지보수가 쉽다.

   > 기존에는 필드 변경 시 모든 SQL을 수정해야 했다면, 필드만 추가하면 된다. SQL은 JPA가 처리하기 때문에 손댈 것이 없다.

4. Object와 RDB 간의 패러다임 불일치 해결



#### 단점

1. 복잡한 쿼리를 사용해야 할 때에 불리하다

   > 업무 비즈니스가 매우 복잡한 경우 JPA로 처리하기 어렵고, 통계처리와 같은 복잡한 쿼리 자체를 ORM으로 표현하는데 한계가 있다.
   >
   > <실시간 처리용 쿼리에 더 최적화되어 있다고 봐도 무방할 것.>

2. 기존 데이터베이스 중심으로 되어 있는 환경에서는 JPA를 사용하기도 어렵고, 힘을 발휘하기 어렵다

3. 잘못 사용할 경우 실제 SQL문을 직접 작성하는 것보다는 성능이 비교적 떨어질 수 있다

4. 대용량 데이터 기반의 환경에서도 튜닝이 어려워 상대적으로 기존 방식보다 성능이 떨어질 수 있다



>  업무 환경, 이러한 장단점을 고려하여 Mybatis를 사용할지 JPA를 사용할지 선택하자



#### JPA를 잘 쓰려면 객체지향 프로그래밍과 관계형 데이터베이스를 둘 다 이해해야 함

